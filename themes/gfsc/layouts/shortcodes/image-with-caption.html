<!-- Allow full markdown in caption -->
<!-- https://oostens.me/posts/hugo-shortcodes-with-markdown-gotchas/ -->

{{ $filename := .Get 0 }}
{{ $alt := .Get 1 }}
{{ $class := slice "image" }}
{{ if .Get 2}}
	{{$userClass := slice "image" (.Get 2) }}
	{{$userClass = delimit $userClass "--"}}
	{{ $class = $class | append $userClass }}
{{ end }}
{{ $class = delimit $class " " }}

<figure
	class="{{ $class }}"
   markdown="0"
>
<div class="image__wrapper image__wrapper--single">
{{ if or (in $filename "http") (in $filename ".svg") }}
<img src="{{ $filename }}" alt="{{ $alt }}" />
{{ else }}       
{{- $src := .Page.Resources.GetMatch $filename }}
{{- $image := $src.Resize "900x" }}
<img src="{{ $image.RelPermalink }}" alt="{{ $alt }}" />
{{ end }}
</div>
<figcaption>
<span class="icon">
<svg
version="1.1"
xmlns="http://www.w3.org/2000/svg"
xmlns:xlink="http://www.w3.org/1999/xlink"
x="0px"
y="0px"
viewBox="0 0 5 19"
style="enable-background: new 0 0 5 19"
xml:space="preserve"
>
<path
	 d="M4.3,3.72H0.7V0.38h3.6V3.72z M4.3,18.62H0.7V5.88h3.6V18.62z"
/>
</svg>
</span>
<span class="desc" markdown="1">
	{{ .Inner }} 
</span>
</figcaption>
</figure>
